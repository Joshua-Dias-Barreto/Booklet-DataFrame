language: smalltalk
sudo: false

os:
  - linux

smalltalk:
  - Pharo-6.1

# Unit tests run the normal pillar tests
# Integration tests test that pillar itself can interact with generated files, pdf generation, etc.
# System tests test that we can install and use pillar as a black box
env:
  matrix:
  - JOB=test TYPE=System ARCHETYPE=book OUTPUT=pdf

install:
  # Pillar installation
  - git clone https://github.com/pillar-markup/pillar.git -b v7.4.1 # Clone pillar before worked with dev-7 
  - cd pillar && ./scripts/build.sh && cd ..                              # Run pillar build script. Pillar will be built in `pwd`/build!
  - . pillar/scripts/ci/ensure_latex.sh                                   # Install latex
  - ./pillar/scripts/ci/ensure_book_dependencies.sh                       # Install latex dependencies required by pillar
  
script:
  - ./pillar/build/pillar build pdf

deploy:
- provider: bintray
  file: .bintray.json
  on:
    repo: SquareBracketAssociates/Booklet-DataFrame
  skip_cleanup: true
  user: ducasse
  key:
    secure: qk7iLGBIHfkza9hkNyJgxe2IsvIWtNzlS/JY8KmmJVlxJ2FHr/vG3/o1r0+KuG4vH3SrAaXgWdt8SC8aBwF4Mz0n7L52uK37R0ABlHLOVBrxd37634ir0NCgLTdYW0MXa2AFq7cG4N3dNMq5rTQnDHgPQVXZEe3iHpqsDRx2Kq4bq/Uyy5bpPetc2aQ/7ataz0ERFpMxs2baJht50yppdc41a3norRfzkIOVfZCSM4yX6a73fxWHoV0FA/KUuqTd1+d7b+Zp7u6dboZat0wSG+vMy7rbghNcWlfpiUAkKRRgMkRYyPFwqeMDoDK0dz+0ERkUjXrYOHFyx21i0+MyTPtLZqWdiZb0XLKnflX1/BUPhgmWsX1ZHAtmvhXjsbeDwbREayDEfOWukBLYLVt7l5XUVaA38/HqZVx6iLFjEMHgaY3ceRDTbNMpTkuXEj1uGUq25wbtazuY+2DFWiRhMCdFyFHmcOHk4hZhFRJ8+vAOyV8B2wqamZbbFpN9phA7cYzxmyk8+UuyJzNNhszfMFz0gdYTwTpQfmz88/9TZrJOGvZbiEbQIQ9+SPz5bXyTo+KgnPVlYgoh8zilJbXOy2NHRoHEmaEr5KgF8ooi9voEMzhQ7Mft0MPSe6eLcP5oGhN9mT08WySIJhKNpSazAh+LlI4y3nf4Epl+i5DPyHQ=