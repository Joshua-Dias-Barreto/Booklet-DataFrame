language: smalltalk
sudo: false

os:
  - linux

smalltalk:
  - Pharo-6.1

# Unit tests run the normal pillar tests
# Integration tests test that pillar itself can interact with generated files, pdf generation, etc.
# System tests test that we can install and use pillar as a black box
env:
  matrix:
  - JOB=test TYPE=System ARCHETYPE=book OUTPUT=pdf

install:
  # Pillar installation
  - git clone https://github.com/pillar-markup/pillar.git -b v7.4.1 # Clone pillar before worked with dev-7 
  - cd pillar && ./scripts/build.sh && cd ..                              # Run pillar build script. Pillar will be built in `pwd`/build!
  - . pillar/scripts/ci/ensure_latex.sh                                   # Install latex
  - ./pillar/scripts/ci/ensure_book_dependencies.sh                       # Install latex dependencies required by pillar
  
script:
  - ./pillar/build/pillar build pdf

deploy:
- provider: bintray
  file: .bintray.json
  on:
    repo: SquareBracketAssociates/Booklet-DataFrame
  skip_cleanup: true
  user: ducasse
  key:
    secure: VygifH8UHzScr2XlTdDFaxO4zVN8pk6TN4dx5tqMCehG14Ath1kk2ItUSo0ha/uz/I3FHZHVUhSydhCMRJUjK1FeFlDobWcOqJ6UEOwoI1GXrs7uNB1v2Htbi4wdnvaC7Oj3Go7cCENUNPqAXeGGWPHPEnX35+0AeXssZPEyv88f6cSAVd4mxCYM6rvxknhyYooodLhFBjZsgdO5ZYKbHU8iiylQNsh3pjvRvZzMeRED3nHMlbHhZXqKJzn+wuiq+loWqV3AFBmxoRuxjU8PU7f+LV8oYvamW6rU3hAPs5SFKqD7aqbAEH6EK3/stjSJGaHz4TzQq0y0Y2PGyLNLJHsgovRhSDKvSzc1iDsNBoe5HeN32TeqS4Kjd2EQrN1n+wMlPHr2Ed5EzSRYfONXtW0HlvYOt5ojSlKIMgAZsBo6hGwrZ330bduhBlNMOgMnYvVh1893dLIQ1F02+TCKIq5I7IO+UafE/MJj3z8i0rcBkMo7Tw8C4hPeIulP4Xfci86wJzG0uQ63FFRwOxMSxYd8qtjJU8jV8swJotfcwgEAwYUcSu2sRfOur0BObW8jqR1Ba3JGAQ0hfQyO0JKalP0MPdQ9QAcMToyoQ13TdtSK+AlhCUNcZTB2a5oXTUYBkYPKmhB5BJIxM7hfCUzYK8vjTxKS1QjbfEehS7jCMKU=